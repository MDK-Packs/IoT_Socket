<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IoT Socket: Using IoT Socket</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="$extra_stylesheet" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="armkeil_white_h.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">IoT Socket
   &#160;<span id="projectnumber">Version 1.3.0</span>
   </div>
   <div id="projectbrief">Simple IP Socket (BSD like)</div>
  </td>
  <!--END !PROJECT_NAME-->
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="Compnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('iot_socket_using.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Using IoT Socket </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_src_IoT_Socket_Using"></a> IoT Socket is available in <a href="https://www.open-cmsis-pack.org/">CMSIS Pack format</a> that simplifies its integration and lifecycle management in complex IoT projects. Section <a class="el" href="index.html#examples">Examples</a> provides information about example projects with IoT Socket interface.</p>
<p >This page explains how to use the IoT Socket pack. It takes <a href="https://developer.arm.com/tools-and-software/embedded/keil-mdk">Keil MDK</a> as the target IDE, but the approach is similar for other development environments supporting CMSIS-Pack concept.</p>
<h1><a class="anchor" id="iot_socket_install"></a>
Pack installation</h1>
<p >IoT Socket pack is public and can be added to the target IDE with the supported pack management service.</p>
<p >With Keil MDK use the <a href="https://www.keil.com/support/man/docs/uv4/uv4_ca_packinstaller.htm"><b>Pack Installer</b></a> utility and in the <a href="https://www.keil.com/support/man/docs/uv4/uv4_ca_packinst_packs.htm"><em>Packs tab</em></a> - <em>Generic</em> category install the <em>MDK-Packs::IoT_Socket</em> pack.</p>
<p ><img src="iot_socket_pack_installer.png" alt="" class="inline" title="IoT Socket in Pack Installer"/></p>
<p >Alternatively, the pack file can be downloaded directly from the <a href="https://developer.arm.com/tools-and-software/embedded/cmsis/cmsis-packs">CMSIS Packs page</a> (in the <em>MDK-Packs</em> category). Double-click the local pack file and it will be added to your development environment.</p>
<h1><a class="anchor" id="iot_socket_select"></a>
Component selection</h1>
<p >IoT Socket pack contains following implementation variants:</p>
<ul>
<li><b>Custom</b>: adds the API header file (<code>iot_socket.h</code>) to the include list and enables a template for custom IoT Socket implementation. See <a class="el" href="iot_socket_using.html#iot_socket_custom">Custom IoT Socket</a> for details.</li>
<li><b>MDK-Network</b>: provides IoT Socket implementation for the <a href="https://www.keil.com/pack/doc/mw/Network/html/index.html">MDK-Middleware Network stack</a>.</li>
<li><b>Mux</b>: implements IoT Socket Multiplexer that allows to retarget communication to a different socket interface at run-time (for example from wireless to wired). See <a class="el" href="iot_socket_using.html#iot_socket_mux">IoT Socket Multiplexer</a> for details.</li>
<li><b>WiFi</b>: provides IoT Socket over <a href="https://arm-software.github.io/CMSIS_5/Driver/html/group__wifi__interface__gr.html">CMSIS-Driver WiFi interface</a>.</li>
<li><b>lwIP</b>: implements IoT Socket on top of the <a href="https://en.wikipedia.org/wiki/LwIP">lwIP stack</a>.</li>
</ul>
<p >You can add an IoT Socket variant to a µVision project as follows:</p><ul>
<li>Open <a href="https://www.keil.com/support/man/docs/uv4/uv4_ca_rtemanager.htm">Manage Run-Time Environment</a>.</li>
<li>Expand <em>IoT Utility</em> group, then <em>Socket (API)</em> group.</li>
<li>Select a single IoT Socket implementation variant.</li>
<li>Resolve any conflicts reported in the <em>Validation Output</em> by adding required components to the project. Press <em>OK</em>.</li>
</ul>
<p ><img src="iot_socket_rte.png" alt="" class="inline" title="IoT Socket in Run-Time Environment"/></p>
<h2><a class="anchor" id="iot_socket_custom"></a>
Custom IoT Socket</h2>
<p ><em>Custom</em> variant of the IoT Socket provides a template for implementing custom IoT Socket. Use the template in a µVision project as follows:</p><ul>
<li>right-click on the target folder in the <em>Project</em> view and in the context menu select <em>Add New Item to Group '&lt;group name&gt;'...</em>.</li>
<li>In the open dialog select <em>User Code Template</em>, then expand <em>IoT Utility</em> component and select <em>Socket:Custom</em>.</li>
<li>In the <em>Name</em> field specify the filename to be used. By default it is <code>iot_socket.c</code>.</li>
<li>Click <em>Add</em> button and the specified template file will be added to the target folder.</li>
</ul>
<p ><img src="iot_socket_template.png" alt="" class="inline" title="IoT Socket Template"/></p>
<ul>
<li>In the added template file provide custom implementation for the IoT Socket stub functions.</li>
</ul>
<h2><a class="anchor" id="iot_socket_mux"></a>
IoT Socket Multiplexer</h2>
<p ><em>Mux</em> variant of the IoT Socket executes the API functions based on the mapping provided by the user with <a class="el" href="group__iotSocketMux.html#ga81c0abb554588a5c6d7498c333646700">iotSocketRegisterApi</a> function. This mechanism allows to retarget IoT communication to a different interface at run-time.</p>
<p >For example the procedure for enabling both MDK-Network and WiFi interfaces would be as follows:</p><ul>
<li>Make sure that all necessary software components for MDK-Middleware and WiFi are present in the project.</li>
<li>Add IoT Socket in <em>Mux</em> variant to your project.</li>
<li>Add an IoT socket implementation for MDK-Middleware Network stack:<ul>
<li>copy <code>source\mdk_network\iot_socket.c</code> from the IoT Socket pack to your application folder.</li>
<li>rename the copied file, for example to <code>iot_socket_mdk.c</code>.</li>
<li>add the file to the application project.</li>
<li>rename all <code>iotSocketXXX</code> functions in the file, for example by changing the prefix and having them as <code>mdkSocketXXX</code>.</li>
</ul>
</li>
<li>Add an IoT socket implementation for WiFi interface:<ul>
<li>copy <code>source\wifi\iot_socket.c</code> from the IoT Socket pack to your application folder.</li>
<li>rename the copied file, for example to <code>iot_socket_wifi.c</code>.</li>
<li>add the file to the application project.</li>
<li>rename all <code>iotSocketXXX</code> functions in the file, for example by changing the prefix and having them as <code>wifiSocketXXX</code>.</li>
</ul>
</li>
<li>In the application code define two API access structures of <a class="el" href="group__iotSocketMux.html#structiotSocketApi__t">iotSocketApi_t</a> type that map the MDK-Network (<code>mdkSocketXXX</code>) and WiFi (<code>wifiSocketXXX</code>) socket functions respectively.</li>
<li>Register the API of the target communication interface using <a class="el" href="group__iotSocketMux.html#ga81c0abb554588a5c6d7498c333646700">iotSocketRegisterApi</a>.</li>
</ul>
<h1><a class="anchor" id="iot_socket_flow"></a>
Operation flow</h1>
<p >A user application typically does not need to call the IoT Socket APIs directly, and instead can rely on the IoT Client interface that manages connectivity to the target service in the cloud (AWS, Azure, Google, proprietary). <a href="https://developer.arm.com/documentation/kan312">Keil Application Note 312</a> explains operation of such IoT clients and shows how IoT Socket is used by them.</p>
<p ><a href="./group__iotSocketAPI.html"><b>IoT Socket functions</b></a> resemble operation of <a href="https://en.wikipedia.org/wiki/Berkeley_sockets">BSD Socket APIs</a> and so the principles of BSD sockets shall be followed when extending IoT clients with IoT Socket support, or when implementing custom IoT Socket variants on top of other network interfaces. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
	Copyright &copy; 2019-2022 Arm Limited (or its affiliates). All rights reserved.
	<!-- Use script below for auto-inserting date, project name, version, etc  -->
	<!-- <script type="text/javascript">
        writeFooter.call(this);
    </script> -->
    </li>
  </ul>
</div>
</body>
</html>
